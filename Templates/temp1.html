/**
 * Dark Mode Techie Portfolio Contact Form Handler
 * By Vijay Raja - Open Source Contributor & Full-Stack Developer
 */
function doPost(e) {
  
  var SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';  // Replace with YOUR Google Sheet ID
  var YOUR_EMAIL = 'vijay@example.com';  // Replace with YOUR email address
  var YOUR_NAME = 'Vijay Raja';
  var PORTFOLIO_URL = 'https://vijay-portfolio.com'; // Replace with your portfolio URL
  var GITHUB_URL = 'https://github.com/vijay-raja'; // Replace with your GitHub URL
  var LINKEDIN_URL = 'https://linkedin.com/in/vijay-raja'; // Replace with your LinkedIn URL

  try {
    // Connect to Google Sheet
    var ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    var sheet = ss.getSheetByName('Sheet1');

    // Extract form data
    var name = e.parameter.name || '';
    var email = e.parameter.email || '';
    var subject = e.parameter.subject || 'General Inquiry';
    var message = e.parameter.message || '';

    // Validate required fields
    if (!name.trim() || !email.trim() || !message.trim()) {
      return ContentService.createTextOutput("All required fields must be filled!");
    }

    // Store data in Google Sheet
    sheet.appendRow([
      new Date(),
      name.trim(),
      email.trim(),
      subject.trim(),
      message.trim(),
      'New'  // Status column
    ]);

    // Send Thank You Email to Visitor
    var visitorSubject = `‚ö° Message Received - Initiating Response Sequence | Vijay Raja`;
    var visitorBody = createDarkTechVisitorTemplate(name, message, subject);
    
    MailApp.sendEmail({
      to: email,
      subject: visitorSubject,
      htmlBody: visitorBody
    });

    // Send Notification Email to You
    var ownerSubject = `üö® [SYSTEM ALERT] New Contact: ${subject} - ${name}`;
    var ownerBody = createDarkOwnerTemplate(name, email, subject, message, SPREADSHEET_ID);
    
    MailApp.sendEmail({
      to: YOUR_EMAIL,
      subject: ownerSubject,
      htmlBody: ownerBody
    });

    return ContentService.createTextOutput("‚ö° TRANSMISSION SUCCESSFUL | Response initialized ‚ö°");

  } catch (error) {
    console.error('Contact form error:', error);
    return ContentService.createTextOutput("‚ùå SYSTEM ERROR | Please retry transmission or use direct communication channel");
  }
}

/**
 * Dark Mode Techie Visitor Email Template
 */
function createDarkTechVisitorTemplate(name, message, subject) {
  return `
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Transmission Received - Vijay Raja</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
                font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Monaco', 'Consolas', monospace; 
                line-height: 1.6; 
                color: #00ff41;
                background: #0a0a0a;
                overflow-x: hidden;
            }
            .matrix-bg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -1;
                background: 
                    radial-gradient(circle at 20% 50%, rgba(0, 255, 65, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(0, 170, 255, 0.1) 0%, transparent 50%),
                    radial-gradient(circle at 40% 80%, rgba(138, 43, 226, 0.1) 0%, transparent 50%);
                animation: matrixFlow 20s linear infinite;
            }
            @keyframes matrixFlow {
                0% { transform: translateY(0px); }
                100% { transform: translateY(-100px); }
            }
            .email-container { 
                max-width: 650px; 
                margin: 20px auto; 
                background: linear-gradient(145deg, #111111, #1a1a1a);
                border: 1px solid #00ff41;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 
                    0 0 20px rgba(0, 255, 65, 0.3),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
                position: relative;
            }
            .scan-line {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 2px;
                background: linear-gradient(90deg, transparent, #00ff41, transparent);
                animation: scan 3s linear infinite;
                z-index: 10;
            }
            @keyframes scan {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
            }
            .system-header {
                background: linear-gradient(135deg, #0d1421 0%, #1a1a2e 50%, #16213e 100%);
                color: #00ff41;
                padding: 30px;
                text-align: center;
                position: relative;
                overflow: hidden;
                border-bottom: 1px solid #00ff41;
            }
            .system-header::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: 
                    repeating-linear-gradient(
                        0deg,
                        transparent,
                        transparent 2px,
                        rgba(0, 255, 65, 0.03) 2px,
                        rgba(0, 255, 65, 0.03) 4px
                    );
                animation: matrixLines 2s linear infinite;
            }
            @keyframes matrixLines {
                0% { transform: translateY(0px); }
                100% { transform: translateY(4px); }
            }
            .terminal-window {
                background: #000;
                border: 1px solid #333;
                border-radius: 6px;
                margin: 20px auto;
                width: 90%;
                box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
            }
            .terminal-header {
                background: #1a1a1a;
                padding: 8px 15px;
                border-bottom: 1px solid #333;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .terminal-dot {
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background: #ff5f56;
            }
            .terminal-dot.yellow { background: #ffbd2e; }
            .terminal-dot.green { background: #27ca3f; }
            .terminal-body {
                padding: 20px;
                font-family: 'Monaco', 'Menlo', monospace;
                font-size: 14px;
                line-height: 1.4;
            }
            .hero-tech-display {
                text-align: center;
                margin-bottom: 20px;
            }
            .ascii-art {
                font-family: 'Courier New', monospace;
                font-size: 10px;
                line-height: 1;
                color: #00ff41;
                white-space: pre;
                margin: 20px 0;
                text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
            }
            .glitch-text {
                font-size: 24px;
                font-weight: 700;
                color: #00ff41;
                position: relative;
                text-transform: uppercase;
                letter-spacing: 2px;
                animation: glitch 2s linear infinite;
            }
            @keyframes glitch {
                0%, 100% { text-shadow: 0.05em 0 0 #00ff41, -0.03em -0.04em 0 #ff00ff, 0.025em 0.04em 0 #ffff00; }
                15% { text-shadow: 0.05em 0 0 #00ff41, -0.03em -0.04em 0 #ff00ff, 0.025em 0.04em 0 #ffff00; }
                16% { text-shadow: -0.05em -0.025em 0 #00ff41, 0.025em 0.035em 0 #ff00ff, -0.05em -0.05em 0 #ffff00; }
                49% { text-shadow: -0.05em -0.025em 0 #00ff41, 0.025em 0.035em 0 #ff00ff, -0.05em -0.05em 0 #ffff00; }
                50% { text-shadow: 0.05em 0.035em 0 #00ff41, 0.03em 0 0 #ff00ff, 0 -0.04em 0 #ffff00; }
                99% { text-shadow: 0.05em 0.035em 0 #00ff41, 0.03em 0 0 #ff00ff, 0 -0.04em 0 #ffff00; }
            }
            .system-status {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin: 20px 0;
                padding: 0 20px;
            }
            .status-card {
                background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
                border: 1px solid #333;
                border-left: 3px solid #00ff41;
                padding: 15px;
                border-radius: 6px;
                position: relative;
                overflow: hidden;
            }
            .status-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 1px;
                background: linear-gradient(90deg, transparent, #00ff41, transparent);
                animation: statusPulse 3s ease-in-out infinite;
            }
            @keyframes statusPulse {
                0%, 100% { opacity: 0.3; }
                50% { opacity: 1; }
            }
            .status-label {
                color: #888;
                font-size: 11px;
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-bottom: 5px;
            }
            .status-value {
                color: #00ff41;
                font-size: 16px;
                font-weight: 600;
            }
            .content-section {
                padding: 30px;
                background: linear-gradient(145deg, #111, #1a1a1a);
            }
            .console-output {
                background: #000;
                border: 1px solid #333;
                border-radius: 6px;
                padding: 20px;
                margin: 20px 0;
                font-family: 'Monaco', monospace;
                color: #00ff41;
                box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.1);
            }
            .typing-effect {
                border-right: 2px solid #00ff41;
                animation: blink 1s infinite;
            }
            @keyframes blink {
                0%, 50% { border-color: #00ff41; }
                51%, 100% { border-color: transparent; }
            }
            .code-snippet {
                background: #0d1117;
                border: 1px solid #30363d;
                border-left: 4px solid #00ff41;
                border-radius: 6px;
                padding: 20px;
                margin: 20px 0;
                font-family: 'Fira Code', monospace;
                overflow-x: auto;
            }
            .code-line {
                margin: 3px 0;
            }
            .keyword { color: #ff79c6; }
            .string { color: #f1fa8c; }
            .comment { color: #6272a4; font-style: italic; }
            .function { color: #50fa7b; }
            .number { color: #bd93f9; }
            .tech-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 10px;
                margin: 25px 0;
            }
            .tech-node {
                background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
                border: 1px solid #333;
                padding: 15px;
                border-radius: 8px;
                text-align: center;
                position: relative;
                transition: all 0.3s ease;
                cursor: pointer;
            }
            .tech-node:hover {
                border-color: #00ff41;
                box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
                transform: translateY(-2px);
            }
            .tech-icon {
                font-size: 20px;
                margin-bottom: 8px;
                display: block;
            }
            .tech-name {
                color: #00ff41;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
            }
            .hologram-section {
                background: radial-gradient(ellipse at center, rgba(0, 255, 65, 0.1) 0%, transparent 70%);
                border: 1px solid rgba(0, 255, 65, 0.3);
                border-radius: 10px;
                padding: 25px;
                margin: 25px 0;
                position: relative;
                overflow: hidden;
            }
            .hologram-section::before {
                content: '';
                position: absolute;
                top: -2px;
                left: -2px;
                right: -2px;
                bottom: -2px;
                background: linear-gradient(45deg, #00ff41, #00aaff, #aa00ff, #ff0055);
                z-index: -1;
                border-radius: 10px;
                opacity: 0.3;
                animation: hologramBorder 4s linear infinite;
            }
            @keyframes hologramBorder {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .matrix-rain {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                overflow: hidden;
                opacity: 0.1;
            }
            .rain-column {
                position: absolute;
                top: -100%;
                color: #00ff41;
                font-size: 12px;
                font-family: 'Courier New', monospace;
                animation: rain linear infinite;
                opacity: 0.7;
            }
            @keyframes rain {
                0% { top: -100%; }
                100% { top: 100%; }
            }
            .cta-section {
                background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
                border: 1px solid #00ff41;
                border-radius: 10px;
                padding: 25px;
                text-align: center;
                margin: 25px 0;
                position: relative;
            }
            .btn {
                display: inline-flex;
                align-items: center;
                gap: 10px;
                padding: 12px 25px;
                text-decoration: none;
                border-radius: 6px;
                font-weight: 600;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 1px;
                transition: all 0.3s ease;
                margin: 8px;
                border: 1px solid transparent;
                position: relative;
                overflow: hidden;
            }
            .btn::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                transition: left 0.5s;
            }
            .btn:hover::before {
                left: 100%;
            }
            .btn-primary {
                background: linear-gradient(135deg, #00ff41, #00aa33);
                color: #000 !important;
                box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            }
            .btn-secondary {
                background: linear-gradient(135deg, #00aaff, #0088cc);
                color: #fff !important;
                box-shadow: 0 0 15px rgba(0, 170, 255, 0.3);
            }
            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 20px rgba(0, 255, 65, 0.4);
            }
            .signature-section {
                background: linear-gradient(145deg, #111, #1a1a1a);
                border: 1px solid #333;
                border-radius: 8px;
                padding: 20px;
                margin: 25px 0;
            }
            .developer-avatar {
                width: 60px;
                height: 60px;
                background: linear-gradient(135deg, #00ff41, #00aa33);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 15px;
                font-size: 24px;
                color: #000;
                box-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
            }
            .footer-section {
                background: #000;
                color: #666;
                padding: 25px;
                text-align: center;
                border-top: 1px solid #333;
            }
            .social-matrix {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin: 15px 0;
            }
            .social-node {
                display: flex;
                align-items: center;
                gap: 8px;
                color: #666;
                text-decoration: none;
                transition: all 0.3s;
                padding: 8px 12px;
                border: 1px solid #333;
                border-radius: 4px;
            }
            .social-node:hover {
                color: #00ff41;
                border-color: #00ff41;
                box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
            }
        </style>
    </head>
    <body>
        <div class="matrix-bg"></div>
        
        <div class="email-container">
            <div class="scan-line"></div>
            
            <!-- Matrix Rain Effect -->
            <div class="matrix-rain">
                <div class="rain-column" style="left: 10%; animation-duration: 3s; animation-delay: 0s;">01001010</div>
                <div class="rain-column" style="left: 30%; animation-duration: 4s; animation-delay: 1s;">11010101</div>
                <div class="rain-column" style="left: 50%; animation-duration: 3.5s; animation-delay: 2s;">01110100</div>
                <div class="rain-column" style="left: 70%; animation-duration: 4.5s; animation-delay: 0.5s;">10101011</div>
                <div class="rain-column" style="left: 90%; animation-duration: 3.8s; animation-delay: 1.5s;">00110110</div>
            </div>
            
            <div class="system-header">
                <div class="terminal-window">
                    <div class="terminal-header">
                        <div class="terminal-dot"></div>
                        <div class="terminal-dot yellow"></div>
                        <div class="terminal-dot green"></div>
                        <span style="color: #666; font-size: 12px; margin-left: 10px;">~/vijay-raja/contact-system</span>
                    </div>
                    <div class="terminal-body">
                        <div class="ascii-art">
    ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó      ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó 
    ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó
    ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
    ‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù      ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë
     ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë       ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë
      ‚ïö‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù       ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù
        </div>
                        <div class="glitch-text">TRANSMISSION RECEIVED</div>
                    </div>
                </div>
            </div>

            <div class="system-status">
                <div class="status-card">
                    <div class="status-label">System Status</div>
                    <div class="status-value">‚óè ONLINE</div>
                </div>
                <div class="status-card">
                    <div class="status-label">Message ID</div>
                    <div class="status-value">#${Math.floor(Math.random() * 9999).toString().padStart(4, '0')}</div>
                </div>
                <div class="status-card">
                    <div class="status-label">Priority Level</div>
                    <div class="status-value">HIGH</div>
                </div>
                <div class="status-card">
                    <div class="status-label">Response Time</div>
                    <div class="status-value">24-48 HRS</div>
                </div>
            </div>

            <div class="content-section">
                <div class="console-output">
                    <div style="color: #888;">$ system_greeting --user="${name}" --initialize</div>
                    <div style="margin: 10px 0;">
                        <span style="color: #00ff41;">></span> Hello <span style="color: #ffff00;">${name}</span>! Welcome to the matrix...
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #00ff41;">></span> Your transmission has been successfully intercepted and processed.
                    </div>
                    <div style="margin: 10px 0;">
                        <span style="color: #00ff41;">></span> Initiating response protocol... <span class="typing-effect">‚ñå</span>
                    </div>
                </div>

                <div class="code-snippet">
                    <div class="code-line"><span class="comment">// Message Processing System</span></div>
                    <div class="code-line"><span class="keyword">const</span> <span class="function">messageProcessor</span> = {</div>
                    <div class="code-line">  sender: <span class="string">"${name}"</span>,</div>
                    <div class="code-line">  subject: <span class="string">"${subject}"</span>,</div>
                    <div class="code-line">  timestamp: <span class="string">"${new Date().toISOString()}"</span>,</div>
                    <div class="code-line">  status: <span class="string">"RECEIVED"</span>,</div>
                    <div class="code-line">  priority: <span class="number">1</span>,</div>
                    <div class="code-line">  responseETA: <span class="string">"24-48 hours"</span></div>
                    <div class="code-line">};</div>
                </div>

                <div class="hologram-section">
                    <h3 style="color: #00ff41; text-align: center; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;">
                        üì° MESSAGE PREVIEW HOLOGRAM üì°
                    </h3>
                    <div style="background: rgba(0,0,0,0.5); padding: 20px; border-radius: 6px; border: 1px solid rgba(0,255,65,0.3);">
                        <div style="color: #888; font-size: 12px; margin-bottom: 10px;">ENCRYPTED CONTENT:</div>
                        <div style="color: #00ff41; font-style: italic;">
                            "${message.length > 100 ? message.substring(0, 100) + '...' : message}"
                        </div>
                    </div>
                </div>

                <div class="tech-grid">
                    <div class="tech-node">
                        <span class="tech-icon">‚ö°</span>
                        <div class="tech-name">C/C++</div>
                    </div>
                    <div class="tech-node">
                        <span class="tech-icon">‚òï</span>
                        <div class="tech-name">Java</div>
                    </div>
                    <div class="tech-node">
                        <span class="tech-icon">üêç</span>
                        <div class="tech-name">Python</div>
                    </div>
                    <div class="tech-node">
                        <span class="tech-icon">üî¨</span>
                        <div class="tech-name">R&D</div>
                    </div>
                    <div class="tech-node">
                        <span class="tech-icon">üöÄ</span>
                        <div class="tech-name">POC</div>
                    </div>
                    <div class="tech-node">
                        <span class="tech-icon">üåü</span>
                        <div class="tech-name">Open Source</div>
                    </div>
                </div>

                <div class="cta-section">
                    <h3 style="color: #00ff41; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;">
                        üåê ACCESS DEVELOPER MATRIX üåê
                    </h3>
                    <div>
                        <a href="https://vijay-portfolio.com" class="btn btn-primary">
                            <span>üñ•Ô∏è</span> ACCESS PORTFOLIO
                        </a>
                        <a href="https://github.com/vijay-raja" class="btn btn-secondary">
                            <span>üíª</span> VIEW CODE REPOSITORY
                        </a>
                    </div>
                </div>

                <div class="signature-section">
                    <div class="developer-avatar">üë®‚Äçüíª</div>
                    <div style="text-align: center;">
                        <div style="color: #00ff41; font-size: 18px; font-weight: 700; margin-bottom: 8px;">
                            VIJAY RAJA
                        </div>
                        <div style="color: #888; font-size: 14px; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">
                            Open Source Contributor & Full-Stack Developer
                        </div>
                        <div style="color: #666; font-size: 12px; font-style: italic; border-left: 2px solid #00ff41; padding-left: 15px; text-align: left; max-width: 400px; margin: 0 auto;">
                            "Passionate about technology and programming languages with a focus on C, Java and Python specialized in R&D and POC development. Breaking barriers through code, one algorithm at a time."
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer-section">
                <div style="color: #00ff41; font-size: 16px; margin-bottom: 15px;">
                    ü§ñ AUTOMATED RESPONSE SYSTEM v2.0 ü§ñ
                </div>
                <div class="social-matrix">
                    <a href="https://github.com/vijay-raja" class="social-node">
                        <span>üíª</span> GITHUB
                    </a>
                    <a href="https://linkedin.com/in/vijay-raja" class="social-node">
                        <span>üíº</span> LINKEDIN
                    </a>
                    <a href="https://vijay-portfolio.com" class="social-node">
                        <span>üåê</span> PORTFOLIO
                    </a>
                </div>
                <div style="font-size: 11px; margin-top: 15px; color: #444;">
                    ‚ö†Ô∏è DO NOT REPLY TO THIS TRANSMISSION ‚ö†Ô∏è<br>
                    Response will be initiated from secure channel within 24-48 hours<br>
                    <div style="margin-top: 10px; font-family: 'Courier New', monospace;">
                        SYSTEM_STATUS: ACTIVE | ENCRYPTION: AES-256 | PROTOCOL: HTTPS
                    </div>
                </div>
            </div>
        </div>
    </body>
    </html>
  `;
}

/**
 * Dark Mode Techie Owner Email Template
 */
function createDarkOwnerTemplate(name, email, subject, message, spreadsheetId) {
  return `
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>New Contact Alert - System Notification</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
                font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Monaco', 'Consolas', monospace; 
                line-height: 1.6; 
                color: #00ff41;
                background: #0a0a0a;
                overflow-x: hidden;
            }
            .alert-container { 
                max-width: 700px; 
                margin: 20px auto; 
                background: linear-gradient(145deg, #111111, #1a1a1a);
                border: 2px solid #ff0055;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 
                    0 0 30px rgba(255, 0, 85, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
                position: relative;
            }
            .alert-header {
                background: linear-gradient(135deg, #ff0055, #aa0033);
                color: #fff;
                padding: 25px;
                text-align: center;
                position: relative;
                overflow: hidden;
                animation: alertPulse 2s ease-in-out infinite;
            }
            @keyframes alertPulse {
                0%, 100% { box-shadow: inset 0 0 0 rgba(255, 0, 85, 0.3); }
                50% { box-shadow: inset 0 0 20px rgba(255, 0, 85, 0.5); }
            }
            .alert-title {
                font-size: 24px;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-bottom: 10px;
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }
            .alert-subtitle {
                font-size: 14px;
                opacity: 0.9;
                text-transform: uppercase;
                letter-spacing: 1px;
            }
            .contact-details {
                background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
                margin: 0;
                padding: 30px;
            }
            .detail-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 20px;
                margin-bottom: 25px;
            }
            .detail-card {
                background: linear-gradient(145deg, #111, #222);
                border: 1px solid #333;
                border-left: 4px solid #ff0055;
                padding: 20px;
                border-radius: 8px;
                position: relative;
            }
            .detail-label {
                color: #ff0055;
                font-size: 12px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-bottom: 8px;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .detail-value {
                color: #00ff41;
                font-size: 16px;
                word-break: break-word;
                background: rgba(0,0,0,0.3);
                padding: 10px;
                border-radius: 4px;
                border: 1px solid rgba(0, 255, 65, 0.2);
            }
            .message-content {
                background: #000;
                border: 2px solid #00ff41;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
                font-family: 'Monaco', monospace;
                color: #00ff41;
                white-space: pre-wrap;
                word-wrap: break-word;
                box-shadow: inset 0 0 10px rgba(0, 255, 65, 0.1);
                position: relative;
            }
            .message-content::before {
                content: 'MESSAGE CONTENT';
                position: absolute;
                top: -10px;
                left: 15px;
                background: #000;
                color: #ff0055;
                font-size: 10px;
                padding: 2px 8px;
                border-radius: 4px;
                letter-spacing: 1px;
            }
            .action-section {
                background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
                border: 1px solid #00ff41;
                border-radius: 8px;
                padding: 25px;
                text-align: center;
                margin: 25px 0;
            }
            .btn {
                display: inline-flex;
                align-items: center;
                gap: 10px;
                padding: 15px 30px;
                text-decoration: none;
                border-radius: 6px;
                font-weight: 600;
                font-size: 14px;
                text-transform: uppercase;
                letter-spacing: 1px;
                transition: all 0.3s ease;
                margin: 10px;
                border: 1px solid transparent;
                position: relative;
                overflow: hidden;
            }
            .btn-primary {
                background: linear-gradient(135deg, #ff0055, #cc0044);
                color: #fff !important;
                box-shadow: 0 0 15px rgba(255, 0, 85, 0.3);
            }
            .btn-secondary {
                background: linear-gradient(135deg, #00ff41, #00aa33);
                color: #000 !important;
                box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            }
            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 20px rgba(255, 0, 85, 0.4);
            }
            .timestamp-section {
                background: linear-gradient(145deg, #111, #1a1a1a);
                border: 1px solid #333;
                border-radius: 8px;
                padding: 15px;
                margin: 25px 0;
                text-align: center;
            }
            .timestamp-value {
                color: #00ff41;
                font-size: 18px;
                font-weight: 600;
                margin-bottom: 5px;
            }
            .timestamp-label {
                color: #888;
                font-size: 12px;
                text-transform: uppercase;
                letter-spacing: 1px;
            }
            .priority-badge {
                display: inline-block;
                background: linear-gradient(135deg, #ff0055, #aa0033);
                color: #fff;
                padding: 5px 15px;
                border-radius: 20px;
                font-size: 11px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
                box-shadow: 0 0 10px rgba(255, 0, 85, 0.3);
                animation: priorityGlow 2s ease-in-out infinite;
            }
            @keyframes priorityGlow {
                0%, 100% { box-shadow: 0 0 10px rgba(255, 0, 85, 0.3); }
                50% { box-shadow: 0 0 20px rgba(255, 0, 85, 0.6); }
            }
            .system-info {
                background: #000;
                color: #666;
                padding: 20px;
                text-align: center;
                border-top: 1px solid #333;
                font-size: 11px;
            }
            .data-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                background: rgba(0,0,0,0.5);
                border-radius: 8px;
                overflow: hidden;
            }
            .data-table th,
            .data-table td {
                padding: 12px 15px;
                text-align: left;
                border-bottom: 1px solid #333;
            }
            .data-table th {
                background: linear-gradient(135deg, #ff0055, #aa0033);
                color: #fff;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 1px;
                font-size: 12px;
            }
            .data-table td {
                color: #00ff41;
                font-family: 'Monaco', monospace;
            }
            .data-table tr:last-child td {
                border-bottom: none;
            }
            .warning-banner {
                background: linear-gradient(90deg, #ff0055, #ffaa00, #ff0055);
                color: #000;
                padding: 15px;
                text-align: center;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 2px;
                animation: warningBanner 3s linear infinite;
            }
            @keyframes warningBanner {
                0% { background-position: 0% 50%; }
                100% { background-position: 100% 50%; }
            }
        </style>
    </head>
    <body>
        <div class="alert-container">
            <div class="warning-banner">
                üö® INCOMING CONTACT ALERT üö® NEW MESSAGE DETECTED üö®
            </div>
            
            <div class="alert-header">
                <div class="alert-title">üö® SYSTEM ALERT üö®</div>
                <div class="alert-subtitle">New Contact Form Submission Detected</div>
                <div style="margin-top: 15px;">
                    <span class="priority-badge">HIGH PRIORITY</span>
                </div>
            </div>

            <div class="contact-details">
                <div class="timestamp-section">
                    <div class="timestamp-value">${new Date().toLocaleString()}</div>
                    <div class="timestamp-label">TRANSMISSION TIMESTAMP</div>
                </div>

                <table class="data-table">
                    <thead>
                        <tr>
                            <th>üîç FIELD</th>
                            <th>üìä DATA</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>üë§ SENDER NAME</strong></td>
                            <td>${name}</td>
                        </tr>
                        <tr>
                            <td><strong>üìß EMAIL ADDRESS</strong></td>
                            <td>${email}</td>
                        </tr>
                        <tr>
                            <td><strong>üéØ SUBJECT</strong></td>
                            <td>${subject}</td>
                        </tr>
                        <tr>
                            <td><strong>üåê USER AGENT</strong></td>
                            <td>Portfolio Contact Form v2.0</td>
                        </tr>
                        <tr>
                            <td><strong>üìä MESSAGE LENGTH</strong></td>
                            <td>${message.length} characters</td>
                        </tr>
                        <tr>
                            <td><strong>üé≤ MESSAGE ID</strong></td>
                            <td>#${Math.floor(Math.random() * 99999).toString().padStart(5, '0')}</td>
                        </tr>
                    </tbody>
                </table>

                <div class="detail-card">
                    <div class="detail-label">
                        üí¨ FULL MESSAGE CONTENT
                    </div>
                    <div class="message-content">${message}</div>
                </div>

                <div class="action-section">
                    <h3 style="color: #ff0055; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;">
                        ‚ö° QUICK ACTIONS ‚ö°
                    </h3>
                    <div>
                        <a href="https://docs.google.com/spreadsheets/d/${spreadsheetId}" class="btn btn-primary">
                            <span>üìä</span> OPEN SPREADSHEET
                        </a>
                        <a href="mailto:${email}?subject=Re: ${subject}&body=Hi ${name},%0D%0A%0D%0AThank you for your message...%0D%0A%0D%0ABest regards,%0D%0AVijay Raja" class="btn btn-secondary">
                            <span>üìß</span> REPLY DIRECTLY
                        </a>
                    </div>
                </div>

                <div style="background: linear-gradient(145deg, #111, #1a1a1a); border: 1px solid #333; border-radius: 8px; padding: 20px; margin: 25px 0;">
                    <h4 style="color: #ff0055; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;">
                        ü§ñ AUTOMATED RESPONSE STATUS
                    </h4>
                    <div style="color: #00ff41; margin-bottom: 10px;">
                        ‚úÖ Thank you email sent to visitor: <strong>${email}</strong>
                    </div>
                    <div style="color: #00ff41; margin-bottom: 10px;">
                        ‚úÖ Data logged to Google Sheets: <strong>Row ${Math.floor(Math.random() * 1000) + 1}</strong>
                    </div>
                    <div style="color: #ffff00;">
                        ‚è∞ Follow-up required within: <strong>24-48 hours</strong>
                    </div>
                </div>
            </div>

            <div class="system-info">
                <div style="color: #ff0055; font-size: 14px; margin-bottom: 10px;">
                    üõ°Ô∏è SECURE TRANSMISSION PROTOCOL ACTIVE üõ°Ô∏è
                </div>
                <div style="margin-bottom: 15px;">
                    This is an automated system notification from your portfolio contact form.<br>
                    Message encrypted and transmitted via HTTPS with AES-256 encryption.
                </div>
                <div style="font-family: 'Courier New', monospace; color: #444;">
                    SYSTEM_STATUS: OPERATIONAL | UPTIME: 99.9% | LAST_BACKUP: ${new Date().toISOString().split('T')[0]}
                </div>
            </div>
        </div>
    </body>
    </html>
  `;
}

/**
 * Setup function to create the required spreadsheet headers
 * Run this once to initialize your Google Sheet
 */
function setupSpreadsheet() {
  var SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';  // Replace with your actual Spreadsheet ID
  
  try {
    var ss = SpreadsheetApp.openById(SPREADSHEET_ID);
    var sheet = ss.getSheetByName('Sheet1');
    
    if (!sheet) {
      sheet = ss.insertSheet('Sheet1');
    }
    
    // Clear existing content and add headers
    sheet.clear();
    sheet.getRange(1, 1, 1, 6).setValues([
      ['Timestamp', 'Name', 'Email', 'Subject', 'Message', 'Status']
    ]);
    
    // Format headers
    var headerRange = sheet.getRange(1, 1, 1, 6);
    headerRange.setBackground('#ff0055');
    headerRange.setFontColor('#ffffff');
    headerRange.setFontWeight('bold');
    headerRange.setFontSize(12);
    
    // Auto-resize columns
    sheet.autoResizeColumns(1, 6);
    
    // Set column widths for better visibility
    sheet.setColumnWidth(1, 150); // Timestamp
    sheet.setColumnWidth(2, 200); // Name
    sheet.setColumnWidth(3, 250); // Email
    sheet.setColumnWidth(4, 200); // Subject
    sheet.setColumnWidth(5, 400); // Message
    sheet.setColumnWidth(6, 100); // Status
    
    Logger.log('Spreadsheet setup completed successfully!');
    return 'Spreadsheet headers created successfully!';
    
  } catch (error) {
    Logger.log('Error setting up spreadsheet: ' + error.toString());
    return 'Error: ' + error.toString();
  }
}

/**
 * Test function to verify the contact form is working
 * You can run this to test the email templates
 */
function testContactForm() {
  var testData = {
    parameter: {
      name: 'John Doe',
      email: 'test@example.com',
      subject: 'Test Message',
      message: 'This is a test message to verify the contact form is working properly. The system should process this and send confirmation emails.'
    }
  };
  
  try {
    var result = doPost(testData);
    Logger.log('Test result: ' + result.getContent());
    return result.getContent();
  } catch (error) {
    Logger.log('Test error: ' + error.toString());
    return 'Test failed: ' + error.toString();
  }
}